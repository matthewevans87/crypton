{
    "_template_note": "strategy.json template. Replace ALL placeholder values. REMOVE ALL '_comment' and '_template_note' keys from final output. Field names and structure must match exactly — the Execution Service validates against strategy.schema.json.",
    "version": "1.0",
    "cycle": "<ISO 8601 datetime of the cycle that produced this strategy>",
    "generatedAt": "<ISO 8601 datetime>",
    "generatedBy": "Synthesis Agent",
    "mode": "<'paper' | 'live'>",
    "validUntil": "<ISO 8601 datetime — the Execution Service will not open new pending positions after this time>",
    "posture": "<'aggressive' | 'moderate' | 'defensive' | 'flat' | 'exit_all'>",
    "rationale": "<2–4 sentences. The dominant thesis for this cycle, what market conditions support it, and the key risk. This is logged and shown on the Monitoring Dashboard — write it as if you will be asked to defend it after a losing trade.>",
    "risk": {
        "_comment": "All values are fractions of portfolio capital (0.10 = 10%). These are hard limits enforced by the Execution Service.",
        "maxDrawdown": "<number 0–1 — halt all trading if total portfolio drawdown exceeds this fraction>",
        "dailyLossLimit": "<number 0–1 — suspend new entries for the calendar day if daily loss reaches this fraction>",
        "maxExposure": "<number 0–1 — maximum fraction of portfolio that may be deployed at once>",
        "maxPositionSize": "<number 0–1 — maximum allocation to any single position>",
        "safeModeTrigger": "<'consecutive_losses' | 'max_drawdown' | 'manual'>"
    },
    "positions": [
        {
            "_comment": "One object per intended position. 'direction': 'close' exits immediately. 'long'/'short' opens or manages a position.",
            "asset": "<trading pair, e.g. 'BTC/USD'>",
            "direction": "<'long' | 'short' | 'close'>",
            "allocation": "<number 0–1 — fraction of total portfolio capital, e.g. 0.10 for 10%>",
            "entryType": "<'market' | 'limit' | 'conditional'>",
            "entryConditions": {
                "_comment": "Required only for entryType='conditional'. Single condition evaluated by Execution Service against live data.",
                "indicator": "<'price' | 'rsi' | 'macd' | 'ema' | 'bollinger_upper' | 'bollinger_lower' | 'volume' | 'atr'>",
                "operator": "<'gt' | 'lt' | 'gte' | 'lte' | 'crosses_above' | 'crosses_below'>",
                "value": "<number — threshold value>"
            },
            "takeProfit": [
                {
                    "_comment": "Scaled exits supported — list multiple targets. Execute in order.",
                    "target": "<number — price target>",
                    "percentage": "<number 0–1 — fraction of this position to close at this target>"
                }
            ],
            "stopLoss": "<number — hard stop price. Required for all non-flat, non-close positions.>",
            "trailingStop": "<number | null — trailing stop as a fraction e.g. 0.03 for 3%. null if not used.>",
            "timeBasedExit": "<ISO 8601 datetime | null — close at this time regardless of P&L. null if unused.>",
            "invalidationCondition": {
                "_comment": "The market state that means the thesis is wrong. Recorded for evaluation.",
                "indicator": "<indicator name>",
                "operator": "<operator>",
                "value": "<threshold number>",
                "description": "<human-readable description of what this condition means>"
            }
        }
    ]
}
